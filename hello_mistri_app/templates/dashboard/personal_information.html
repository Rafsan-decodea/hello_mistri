{% extends 'dashboard/index.html' %}
{%load static%}


{% block body %}
<meta name="viewport" content="width=device-width, initial-scale=1.0">
            
 


<br><br><br><br>
        <div class="pcoded-content  ">
                        <div class="pcoded-inner-content ">

                            <!-- Main-body start -->
                            <div class="main-body ">
                                <div class="page-wrapper ">
                                <!-- Page-header start -->
                                    <div class="page-body">

                                        <div class="row">
                                            <div class="col-sm-12">
                                                <!-- Typography card start -->
                                                <div class="card">
                                                    <div class="card-header">
                
                                                    <div class="card-header-right">   
                                                                                                                 <i class="icofont icofont-spinner-alt-5"></i>                                                         </div>
                                                    </div>
                                                    <div class="card-block typography">
                                                        <div class="row">
                                                            <div class="col-sm-12 col-xl-10">
                                                               

   <form id="contact-form-mistri" method="POST"  enctype="multipart/form-data"   onsubmit="onForSubmit(event)">
      {% csrf_token %}
  
   <input type="hidden" hidden  id="mistri_uid" name="mistri_uid">

    <div class="controls">

        <div class="row">
            <div class="col-md-10">
                <div class="form-group">
                    <label for="form_name">আপনার নাম *</label>
                    <input id="yourname"  type="text" name="name" class="form-control "  placeholder="Please enter your firstname *" required="required" data-error="Firstname is required.">
                    <div class="help-block with-errors"></div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <label for="form_lastname">আপনার মোবাইল *</label>
                    <input  id="yourmobilenumber" type="number" name="number" class="form-control yourmobilenumber" placeholder="Please enter your lastname *" required="required" data-error="Lastname is required.">
                    <div class="help-block with-errors"></div>
                </div>
            </div>
        </div>
        <div class="row">

            <div class="col-md-10">
                <div class="form-group">
                    <label for="form_email">আপনি কোথায় থাকেন  *</label>
                    <input   name="email" class="form-control" id="address"  data-error="Valid email is required.">
                    <div class="help-block with-errors"></div>
                </div>
            </div>

           
            <div class="col-md-6">
                <div class="form-group">
                    <label for="form_email">আপনার জন্ম তারিখ  *</label>
                    <input  id="dateofbirth" name="dob" class="form-control dateofbirth" placeholder="Please enter your email *" required="required" data-error="Valid email is required.">
                    <div class="help-block with-errors"></div>
                </div>
                
           
            
            </div>
            
            </div>

        </div>

        <div class="col-md-6">
            <div class="form-group">
                <label for="form_email">আপনার ID Card Photo *</label>
               
            </div>

            <div class="card" style="width: 15rem;">
               <img class="card-img-top" id="mistri_dob_image"  alt="আপনার ছবি দেওয়া নেই">
                 <div class="card-body">
                     <p class="card-text">পরিবর্তন করুন</p>
                     <input type="file" id="image" name="image" >
                 </div>
            </div>
     
        </div>
        <div class="row">
             <div class="col-md-5">
                <div class="form-group">
                    <strong><p>আপনার City</p></strong>
                    <div id="city_name"></div>
                    <br>
                   
                    <div class="help-block with-errors"></div>
                </div>
                <div class="form-group">
                <strong><p>আপনার Area</p></strong>
                <div id="area_name"></div>
                <br>
                <strong><p>আপনার Sub Area</p></strong>
                <div id="sub_area_name"></div>
                <br>
                </div>
            </div>
            <div class="col-md-7">
                <div class="form-group">
                    <strong><p>আপনার প্রদান কৃত সার্ভিস সমুহ</p></strong>
                    <div id="service_list"></div>
                    <br>
                   
                    <div class="help-block with-errors"></div>
                </div>
                <div class="form-group">
                <strong><p>আপনার Area</p></strong>
                <div id="hello"></div>
                <br>
                <strong><p>আপনার Sub Area</p></strong>
                <div id="sub_are"></div>
                <br>
                </div>
            </div>
           
        </div>
        
        <div class="col-md-12">
                <input type="submit" class="btn btn-success btn-send" id="upload" value="update">
            </div>
    </div>



</form>

</div>








<form id="contact-form-client" method="POST" >

    {% csrf_token %}
   <input type="text" hidden  id="client_uid" name="client_uid">

    <div class="controls">

        <div class="row">
           <div class="col-md-10">
                <div class="form-group">
                    <label for="form_lastname">আপনার নাম *</label>
                    <input id="yourname1" type="text" name="name" class="form-control" required>
                    <div class="help-block with-errors"></div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <label for="form_lastname">আপনার মোবাইল *</label>
                    <input id="yourphone" type="text" name="phone" class="form-control" required>
                    <div class="help-block with-errors"></div>
                </div>
            </div>
        </div>
        
          
        </div>
        <div class="row">
             <div class="col-md-10">
                <div class="form-group">
                    <label for="form_email">আপনার ঠিকানা  *</label>
                    <textarea id="address"  name="address" class="form-control" required ></textarea>
                    <div class="help-block with-errors"></div>
                </div>
            </div>
            <div class="col-md-12">
                <input type="submit" class="btn btn-success btn-send" value="update">
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <p class="text-muted">
                    <strong>*</strong> These fields are required. Contact form template by
                    <a href="https://bootstrapious.com/p/how-to-build-a-working-bootstrap-contact-form" target="_blank">Bootstrapious</a>.</p>
            </div>
        </div>
    </div>

</form>

</div>

</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>


<button type="button" hidden id="success" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter">
 
</button>

<!-- Modal -->
<div class="modal fade " id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered bg-success" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title text-primary" id="exampleModalLongTitle">Status</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body text-primary" id="show_massage" >
      
      </div>
      
    </div>
  </div>
</div>






<script>

  const form = document.getElementById("contact-form-client");
  form.addEventListener("submit",submitHandler);

  function submitHandler(e)
  {
      e.preventDefault();
      $.djangocsrf( "enable" );
      $.ajax({
          type: "POST",
          url:"{%url 'update_client'%}",
          data:$("#contact-form-client").serialize(),
          dataType:"json",
          success: function(data)
          {
              if(data.msg == "Success")
              {
                  
                  $(document).ready(function(){

                        $("#success").click();
                         document.getElementById("show_massage").innerHTML = "Data Save Successfully .. Do Refresh to See Changes";
                     })
                   
              }
             
          }
      })
  };



function onForSubmit(event){

    event.preventDefault();

    var formData  = new FormData(document.getElementById("contact-form-mistri"));
    $.ajax({
        method   : "POST",
        url      : "{% url 'update_mistri' %}",
        data     : formData,
        processData:false,
        contentType:false,
        success  : function(data){
    
             $(document).ready(function(){
                       
                            
                         $("#success").click();
                          document.getElementById("show_massage").innerHTML = "Data Save Successfully .. Do Refresh For See Changes";
                    
                     });
     
                   
        },
        error    : function(data){
            console.log("ERROR:CH0x2 while fetching after creation form submit");
            console.log("data :",data.status, data.statusText);
        }
    });


}





</script>







{% endblock %}